{"version":3,"sources":["keditor-component-video.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","video","find","parent","is","wrap","getContent","unwrap","html","settingEnabled","settingTitle","initSettingForm","form","append","showSettingForm","options","fileInput","btnVideoFileInput","on","e","preventDefault","trigger","off","file","this","files","test","type","attr","URL","createObjectURL","load","showSettingPanel","alert","autoplayToggle","checked","prop","removeProp","loopToggle","ratio","currentWidth","css","replace","currentRatio","value","height","showcontrolsToggle","removeAttr","videoWidth","val","jQuery"],"mappings":"CAAA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBC,KAAM,SAAUC,EAAaC,EAAWC,EAAWP,GAC/CC,EAAK,yBAA0BM,EAE/B,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAQF,EAAiBG,KAAK,QAE7BD,GAAME,SAASC,GAAG,mBACnBH,EAAMI,KAAK,sCAInBC,WAAY,SAAUR,EAAWP,GAC7BC,EAAK,+BAAgCM,EAErC,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAQF,EAAiBG,KAAK,QAGlC,OAFAD,GAAMM,SAECR,EAAiBS,QAG5BC,gBAAgB,EAEhBC,aAAc,iBAEdC,gBAAiB,SAAUC,EAAMrB,GAC7BC,EAAK,wBAAyBoB,GAE9BA,EAAKC,OACD,2qDA+CRC,gBAAiB,SAAUF,EAAMd,EAAWP,GACxCC,EAAK,mCAAoCoB,EAAMd,EAE/C,IAAIiB,GAAUxB,EAAQwB,QAClBd,EAAQH,EAAUI,KAAK,SACvBc,EAAYJ,EAAKV,KAAK,mBACtBe,EAAoBL,EAAKV,KAAK,sBAClCe,GAAkBC,GAAG,QAAS,SAAUC,GACpCA,EAAEC,iBAEFJ,EAAUK,QAAQ,WAEtBL,EAAUM,IAAI,UAAUJ,GAAG,SAAU,WACjC,GAAIK,GAAOC,KAAKC,MAAM,EAClB,SAAQC,KAAKH,EAAKI,OAGlB1B,EAAM2B,KAAK,MAAOC,IAAIC,gBAAgBP,IAEtCtB,EAAM8B,KAAK,WACPxC,EAAQyC,iBAAiBlC,EAAWiB,MAGxCkB,MAAM,6CAId,IAAIC,GAAiBtB,EAAKV,KAAK,kBAC/BgC,GAAeZ,IAAI,SAASJ,GAAG,QAAS,SAAUC,GAC1CK,KAAKW,QACLlC,EAAMmC,KAAK,YAAY,GAEvBnC,EAAMoC,WAAW,aAIzB,IAAIC,GAAa1B,EAAKV,KAAK,cAC3BoC,GAAWhB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GACtCK,KAAKW,QACLlC,EAAMmC,KAAK,QAAQ,GAEnBnC,EAAMoC,WAAW,SAIzB,IAAIE,GAAQ3B,EAAKV,KAAK,eACtBqC,GAAMjB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GACrC,GAAIK,KAAKW,QAAS,CACd,GAAIK,GAAevC,EAAMwC,IAAI,UAAYxC,EAAMmC,KAAK,QACpDI,GAAeA,EAAaE,QAAQ,KAAM,GAE1C,IAAIC,GAA8B,SAAfnB,KAAKoB,MAAmB,GAAK,EAAI,EAAI,EACpDC,EAASL,EAAeG,CAC5B1C,GAAMwC,IAAI,QAASD,EAAe,MAClCvC,EAAMwC,IAAI,SAAUI,EAAS,MAC7B5C,EAAMoC,WAAW,SACjBpC,EAAMoC,WAAW,YAIzB,IAAIS,GAAqBlC,EAAKV,KAAK,sBACnC4C,GAAmBxB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GAC9CK,KAAKW,QACLlC,EAAM2B,KAAK,WAAY,YAEvB3B,EAAM8C,WAAW,aAIzB,IAAIC,GAAapC,EAAKV,KAAK,eAC3B8C,GAAW1B,IAAI,UAAUJ,GAAG,SAAU,WAClCjB,EAAMwC,IAAI,QAASjB,KAAKoB,MAAQ,KAChC,IAAID,GAA2D,SAA5C/B,EAAKV,KAAK,wBAAwB+C,MAAmB,GAAK,EAAI,EAAI,EACjFJ,EAASrB,KAAKoB,MAAQD,CAC1B1C,GAAMwC,IAAI,SAAUI,EAAS,MAC7B5C,EAAMoC,WAAW,SACjBpC,EAAMoC,WAAW,eAI9Ba","file":"keditor-component-video.min.js","sourcesContent":["(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['video'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"video\" component', component);\r\n\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var video = componentContent.find('video');\r\n\r\n            if (!video.parent().is('.video-wrapper')) {\r\n                video.wrap('<div class=\"video-wrapper\"></div>');\r\n            }\r\n        },\r\n\r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"video\" component', component);\r\n\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var video = componentContent.find('video');\r\n            video.unwrap();\r\n\r\n            return componentContent.html();\r\n        },\r\n\r\n        settingEnabled: true,\r\n\r\n        settingTitle: 'Video Settings',\r\n\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"video\" settings', form);\r\n\r\n            form.append(\r\n                '<form class=\"form-horizontal\">' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"videoFileInput\" class=\"col-sm-12\">Video file</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <div class=\"video-toolbar\">' +\r\n                '                <a href=\"#\" class=\"btn-videoFileInput btn btn-sm btn-primary\"><i class=\"fa fa-upload\"></i></a>' +\r\n                '                <input id=\"videoFileInput\" type=\"file\" style=\"display: none\">' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"video-autoplay\" class=\"col-sm-12\">Autoplay</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"checkbox\" id=\"video-autoplay\" />' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"video-loop\" class=\"col-sm-12\">Loop</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"checkbox\" id=\"video-loop\" />' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"video-showcontrols\" class=\"col-sm-12\">Show Controls</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"checkbox\" id=\"video-showcontrols\" checked />' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"\" class=\"col-sm-12\">Ratio</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"radio\" name=\"video-radio\" class=\"video-ratio\" value=\"4/3\" checked /> 4:3' +\r\n                '        </div>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"radio\" name=\"video-radio\" class=\"video-ratio\" value=\"16/9\" /> 16:9' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '    <div class=\"form-group\">' +\r\n                '        <label for=\"video-width\" class=\"col-sm-12\">Width (px)</label>' +\r\n                '        <div class=\"col-sm-12\">' +\r\n                '            <input type=\"number\" id=\"video-width\" min=\"320\" max=\"1920\" class=\"form-control\" value=\"320\" />' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</form>'\r\n            );\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"video\" settings', form, component);\r\n\r\n            var options = keditor.options;\r\n            var video = component.find('video');\r\n            var fileInput = form.find('#videoFileInput');\r\n            var btnVideoFileInput = form.find('.btn-videoFileInput');\r\n            btnVideoFileInput.on('click', function (e) {\r\n                e.preventDefault();\r\n\r\n                fileInput.trigger('click');\r\n            });\r\n            fileInput.off('change').on('change', function () {\r\n                var file = this.files[0];\r\n                if (/video/.test(file.type)) {\r\n                    // Todo: Upload to your server :)\r\n\r\n                    video.attr('src', URL.createObjectURL(file));\r\n\r\n                    video.load(function () {\r\n                        keditor.showSettingPanel(component, options);\r\n                    });\r\n                } else {\r\n                    alert('Your selected file is not an video file!');\r\n                }\r\n            });\r\n\r\n            var autoplayToggle = form.find('#video-autoplay');\r\n            autoplayToggle.off('click').on('click', function (e) {\r\n                if (this.checked) {\r\n                    video.prop('autoplay', true);\r\n                } else {\r\n                    video.removeProp('autoplay');\r\n                }\r\n            });\r\n\r\n            var loopToggle = form.find('#video-loop');\r\n            loopToggle.off('click').on('click', function (e) {\r\n                if (this.checked) {\r\n                    video.prop('loop', true);\r\n                } else {\r\n                    video.removeProp('loop');\r\n                }\r\n            });\r\n\r\n            var ratio = form.find('.video-ratio');\r\n            ratio.off('click').on('click', function (e) {\r\n                if (this.checked) {\r\n                    var currentWidth = video.css('width') || video.prop('width');\r\n                    currentWidth = currentWidth.replace('px', '');\r\n\r\n                    var currentRatio = this.value === '16/9' ? 16 / 9 : 4 / 3;\r\n                    var height = currentWidth / currentRatio;\r\n                    video.css('width', currentWidth + 'px');\r\n                    video.css('height', height + 'px');\r\n                    video.removeProp('width');\r\n                    video.removeProp('height');\r\n                }\r\n            });\r\n\r\n            var showcontrolsToggle = form.find('#video-showcontrols');\r\n            showcontrolsToggle.off('click').on('click', function (e) {\r\n                if (this.checked) {\r\n                    video.attr('controls', 'controls');\r\n                } else {\r\n                    video.removeAttr('controls');\r\n                }\r\n            });\r\n\r\n            var videoWidth = form.find('#video-width');\r\n            videoWidth.off('change').on('change', function () {\r\n                video.css('width', this.value + 'px');\r\n                var currentRatio = form.find('.video-ratio:checked').val() === '16/9' ? 16 / 9 : 4 / 3;\r\n                var height = this.value / currentRatio;\r\n                video.css('height', height + 'px');\r\n                video.removeProp('width');\r\n                video.removeProp('height');\r\n            });\r\n        }\r\n    };\r\n})(jQuery);\r\n"]}